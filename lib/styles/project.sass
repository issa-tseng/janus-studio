@import './common'

.assembly
  padding: 1em
    top: 0

  .assembly-name input
    @include no-appearance
    font-family: $font-main
    font-size: 1.5em
    font-weight: bold
    letter-spacing: -0.02em
    margin-bottom: 0.2em

  .assembly-statements
    background: #fff
    border-radius: 0.35em
    box-shadow: $subtle-shadow
    width: 40em

  .assembly-stacks
    @include fill
    left: 42em
    top: 3.5em

  .console
    background: rgba(200, 200, 200, 0.9)
    border-radius: 0.3em 0.3em 0 0
    bottom: 0
    left: 0
    min-width: 32em
    padding: 1em
    position: absolute
    transition: background 0.2s
    z-index: $z-console

    &.count-0
      background: transparentize($color-page-bg, 0.1)

  .console-clear
    @include no-appearance
    color: #fff
    font-size: 2em
    font-weight: bold
    line-height: 0.3em
    margin-bottom: 0.3em
    padding: 0.3em

  .console-input
    background: #fff
    border-radius: 0.3em
    box-shadow: $subtle-shadow
    padding: 0.6em 0.8em
      left: 3em
    position: relative

    &::before
      $size: 1em
      @include reify
      border-top-right-radius: 0.2em
      border-right: 2px solid #bbb
      border-top: 2px solid #bbb
      height: $size
      left: 0.9em
      position: absolute
      top: 1.1em
      transform: rotate(45deg)
      width: $size

    .code-editor
      font-size: 1.2em

  .console-output
    margin: 0 -1em -2em
    //max-height: calc(100vh - 20em)
    //overflow-y: auto
    padding: 0 1em 2em
    width: 32em

    &::-webkit-scrollbar
      background: rgba(0, 0, 0, 0.1)
      width: 0.2em
    &::-webkit-scrollbar-thumb
      background: $color-accent

    .block
      margin-bottom: 1em

.stack
  float: left
  padding: 0 0.5em
  width: 30em

  h1 input
    @include no-appearance
    color: #444
    font-size: 1em
    font-weight: bold
    letter-spacing: -0.02em
    margin-top: 0.5em

  .stack-blocks
    height: calc(100vh - 10em) // TODO: centralize this measurement.
    margin-top: 0.9em

    > .janus-list > .block
      margin-bottom: 1.5em
      transition: 0.7s transform $ease-extreme-out

.block
  position: relative

  .block-delete
    // TODO: repetitive with at least .block-run/.console-clear
    @include no-appearance
    opacity: 0
    padding: 0.3em 0.6em
    position: absolute
    right: 0.25em
    top: 0.25em
    transition: 0.3s opacity ease-out
    z-index: 1
  &:hover .block-delete
    opacity: 0.3
    transition: none
  .block-delete:hover
    opacity: 1

  &.type-reference
    .block-handle, .block-title, .block-code, .block-run
      display: none

  &.type-action
    // TODO: copied from panel
    background-color: #fff
    border-radius: 0.35em
    box-shadow: $subtle-shadow
    padding: 1em

    // TODO: copied from panel
    .block-handle
      $width: 6em
      @include drag-affordance(#888)
      height: 0.3em
      left: calc(50% - #{$width / 2})
      opacity: 0
      position: absolute
      top: 0.8em
      transition: 0.3s opacity ease-out
      width: $width + 0.1em
    &:hover .block-handle
      opacity: 0.3
      transition: none
    .block-handle:hover
      opacity: 1

    .block-title
      color: $color-action
      font-family: $font-monospace
      font-size: 1.1em

    .block-code
      background: $color-page-bg
      border-bottom: 1px dotted #f0f0f0
      border-top: 1px dotted #f0f0f0
      cursor: text
      margin: 1em -1em 0.5em
      padding: 0.5em 1em

      *
        cursor: text

    .block-run
      @include no-appearance
      font-size: 2.6em
      line-height: 0.3em
      padding: 0.3em
      position: absolute
      right: 0.3em
      margin-top: -0.7em

    &.stale .block-target
      filter: grayscale(0.7)
      opacity: 0.7

    .janus-inspect-panel
      // TODO: copied from atom
      border: 1px dotted #ddd
      box-shadow: none
      margin: 1em -0.6em 0

.console-output .block
  animation-duration: 1s
  animation-iteration-count: 1
  animation-name: slide-up
  animation-timing-function: $ease-extreme-out

