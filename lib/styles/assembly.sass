@import './common'


////////////////////////////////////////////////////////////////////////////////
// assembly

.assembly
  padding: 1em
    top: 0

  .assembly-name input
    @include no-appearance
    font-family: $font-main
    font-size: 1.5em
    font-weight: bold
    letter-spacing: -0.02em
    margin-bottom: 0.2em

  .assembly-tools
    right: calc(100vw - 41.5em)
    position: absolute
    top: 4.8em

    button
      @include no-appearance
      font-size: 1.6em
      padding: 0 0.25em

      &.checked
        color: $color-accent

  .assembly-save
    &.saved
      animation-duration: 1.8s
      animation-iteration-count: 1
      animation-name: flash-green

  .assembly-statements
    background: #fff
    border-radius: 0.35em
    box-shadow: $subtle-shadow
    width: 40em

  .assembly-main
    left: 42em
    position: absolute
    top: 3.5em

  .assembly-pin > div
    animation-duration: 1s
    animation-iteration-count: 1
    animation-name: slide-up
    animation-timing-function: $ease-extreme-out
    margin: 4.4em 0 2em

  .assembly-stacks
    width: 99em

    .stack
      float: left
      width: 30em

    .new-stack
      @include no-appearance
      font-size: 1.4em
      margin-top: 1em
      opacity: 0.6
      padding: 0 0.4em calc(100vh - 6em)
      position: relative
      transition: 0.3s opacity
      &::after
        @include reify
        border-left: 1px solid #ddd
        box-shadow: -1px 0 0 #888
        bottom: 0
        left: 0.68em
        opacity: 0
        position: absolute
        top: 1.3em
        transition: 0.3s opacity
      &:hover
        opacity: 1
        transition: none
      &:hover::after
        opacity: 1
        transition: none

  .console
    background: rgba(200, 200, 200, 0.9)
    border-radius: 0.3em 0.3em 0 0
    bottom: 0
    left: 0
    min-width: 32em
    padding: 1em
    position: absolute
    transition: background 0.2s
    z-index: $z-console

    &.count-0
      background: transparentize($color-page-bg, 0.1)

  .console-clear
    @include no-appearance
    color: #fff
    font-size: 2em
    font-weight: bold
    line-height: 0.3em
    margin-bottom: 0.3em
    padding: 0.3em

  .console-input
    background: #fff
    border-radius: 0.3em
    box-shadow: $subtle-shadow
    padding: 0.6em 0.8em
      left: 3em
    position: relative

    &::before
      $size: 1em
      @include reify
      border-top-right-radius: 0.2em
      border-right: 2px solid #bbb
      border-top: 2px solid #bbb
      height: $size
      left: 0.9em
      position: absolute
      top: 1.1em
      transform: rotate(45deg)
      width: $size

    .code-editor
      font-size: 1.2em

  .console-output
    margin: 0 -1em -2em
    //max-height: calc(100vh - 20em)
    //overflow-y: auto
    padding: 0 1em 2em
    width: 32em

    &::-webkit-scrollbar
      background: rgba(0, 0, 0, 0.1)
      width: 0.2em
    &::-webkit-scrollbar-thumb
      background: $color-accent

    .block
      margin-bottom: 1em


////////////////////////////////////////////////////////////////////////////////
// statement

.statement
  position: relative

  .statement-name-edit input
    @include no-appearance
    color: $color-binding
    font-family: $font-monospace
    padding-top: 0.1em
    position: absolute

    &::placeholder
      color: #ccc

  .statement-code
    background: $color-page-bg
    border-bottom: 1px dotted #f0f0f0
    border-top: 1px dotted #f0f0f0
    cursor: text
    margin: 0 -1em 0.5em
    padding: 0.5em 1em

    *
      cursor: text

  .statement-lower
    padding: 0.4em
      bottom: 0
    position: relative

  .statement-name
    font-family: $font-monospace
    font-size: 1.1em
    padding-right: 0.3em
    .name
      visibility: hidden
    .binding
      padding-left: 0.5em

  .statement-result
    position: relative
    z-index: 1 // TODO: centralize?

    > .janus-inspect-entity, > .janus-literal
      font-size: 1.1em

    .janus-inspect-panel
      border: 1px dotted #ddd
      box-shadow: none
      margin: 1em -0.6em 0

    .exception
      margin-top: 0.5em

  ////////////////////////////////////////
  // button things
  // TODO: the classing here is a bit of a mess.

  > button, .statement-panel button
    font-size: 1.3em
    opacity: 0
    position: absolute

  button
    @include no-appearance
    transition: opacity 0.3s ease-out
  &:hover
    > button, .statement-panel button
      opacity: 0.08
      transition: none
  button:hover, .statement-panel button:hover
    opacity: 1

  &:hover + .statement .statement-insert
    opacity: 0.08
    transition: none

  .statement-insert
    display: block
    left: 0
    top: -0.75em
    width: 100%
    &::before, &::after
      @include reify
      border-top: 1px solid #000
      position: absolute
      top: 0.7em
      width: calc(50% - 0.8em)
    &::before
      left: 0
    &::after
      right: 0

  .statement-remove, .statement-panel button
    padding: 0 0.3em
  .statement-remove
    right: 0.4em
    top: 0.05em
  .statement-panel button
    right: -0.45em
    top: 0.2em

  ////////////////////////////////////////
  // state toggles

  &.is-panel .statement-panel button
    color: $color-accent
    opacity: 1

  .statement-panel
    display: none
  &.has-result .statement-panel
    display: block

  .statement-name .binding
    color: #ccc
  &.has-name .statement-name .binding
    color: #666


.assembly .statement
  padding: 1em


